2025-09-22 13:01:51,535 - INFO - Starting LIMITED OpenAQ data ingestion test...
2025-09-22 13:01:51,535 - INFO - Fetching locations for Nepal (ID: 145)...
2025-09-22 13:01:54,467 - INFO -   Page 1: 14 locations fetched
2025-09-22 13:01:54,468 - INFO - Total locations for Nepal: 14
2025-09-22 13:01:54,533 - INFO - Saved 14 locations records to test_data/test_locations_20250922_130154.parquet
2025-09-22 13:01:54,533 - INFO -   Columns: ['id', 'name', 'locality', 'timezone', 'country', 'owner', 'provider', 'isMobile', 'isMonitor', 'instruments', 'sensors', 'coordinates', 'licenses', 'bounds', 'distance', 'datetimeFirst', 'datetimeLast']
2025-09-22 13:01:54,534 - INFO -   Shape: (14, 17)
2025-09-22 13:01:54,538 - INFO - Saved 66 sensors records to test_data/test_sensors_20250922_130154.parquet
2025-09-22 13:01:54,538 - INFO -   Columns: ['sensor_id', 'sensor_name', 'parameter', 'location_id', 'location_name', 'location_locality', 'country', 'coordinates', 'timezone', 'owner', 'provider']
2025-09-22 13:01:54,538 - INFO -   Shape: (66, 11)
2025-09-22 13:01:54,538 - INFO - Testing measurement collection for 2 sensors...
2025-09-22 13:01:54,539 - INFO - Processing sensor 1/2: 7713
2025-09-22 13:01:54,539 - INFO - Fetching measurements for sensor 7713 (o3 ppm)...
2025-09-22 13:01:58,825 - INFO -   Page 1: 1000 measurements fetched
2025-09-22 13:02:04,359 - INFO -   Page 2: 1000 measurements fetched
2025-09-22 13:02:09,649 - INFO -   Page 3: 1000 measurements fetched
2025-09-22 13:02:15,653 - INFO -   Page 4: 1000 measurements fetched
2025-09-22 13:02:21,470 - INFO -   Page 5: 1000 measurements fetched
2025-09-22 13:02:27,622 - INFO -   Page 6: 1000 measurements fetched
2025-09-22 13:02:34,239 - INFO -   Page 7: 1000 measurements fetched
2025-09-22 13:02:41,271 - INFO -   Page 8: 1000 measurements fetched
2025-09-22 13:02:47,965 - INFO -   Page 9: 1000 measurements fetched
2025-09-22 13:02:55,811 - INFO -   Page 10: 1000 measurements fetched
2025-09-22 13:03:04,005 - INFO -   Page 11: 1000 measurements fetched
2025-09-22 13:03:11,005 - INFO -   Page 12: 1000 measurements fetched
2025-09-22 13:03:20,205 - INFO -   Page 13: 1000 measurements fetched
2025-09-22 13:03:30,475 - INFO -   Page 14: 1000 measurements fetched
2025-09-22 13:03:40,554 - INFO -   Page 15: 1000 measurements fetched
2025-09-22 13:03:57,188 - ERROR - API request failed for https://api.openaq.org/v3/sensors/7713/measurements: 500 Server Error: Internal Server Error for url: https://api.openaq.org/v3/sensors/7713/measurements?date_from=2024-01-01T00%3A00%3A00Z&date_to=2025-09-22T07%3A16%3A54.539087%2B00%3A00&page=16&limit=1000
2025-09-22 13:03:57,193 - INFO - Total measurements for sensor 7713: 15000
2025-09-22 13:03:57,215 - INFO - Processing sensor 2/2: 7710
2025-09-22 13:03:57,222 - INFO - Fetching measurements for sensor 7710 (pm25 µg/m³)...
2025-09-22 13:04:01,723 - INFO -   Page 1: 1000 measurements fetched
2025-09-22 13:04:06,658 - INFO -   Page 2: 1000 measurements fetched
2025-09-22 13:04:12,054 - INFO -   Page 3: 1000 measurements fetched
2025-09-22 13:04:16,674 - INFO -   Page 4: 1000 measurements fetched
2025-09-22 13:04:22,378 - INFO -   Page 5: 1000 measurements fetched
2025-09-22 13:04:28,568 - INFO -   Page 6: 1000 measurements fetched
2025-09-22 13:04:33,826 - INFO -   Page 7: 1000 measurements fetched
2025-09-22 13:04:39,260 - INFO -   Page 8: 1000 measurements fetched
2025-09-22 13:04:45,993 - INFO -   Page 9: 1000 measurements fetched
2025-09-22 13:04:53,184 - INFO -   Page 10: 1000 measurements fetched
2025-09-22 13:05:00,305 - INFO -   Page 11: 1000 measurements fetched
2025-09-22 13:05:08,880 - INFO -   Page 12: 1000 measurements fetched
2025-09-22 13:05:18,792 - INFO -   Page 13: 1000 measurements fetched
2025-09-22 13:05:27,879 - INFO -   Page 14: 1000 measurements fetched
2025-09-22 13:05:37,209 - INFO -   Page 15: 1000 measurements fetched
2025-09-22 13:05:47,330 - INFO -   Page 16: 1000 measurements fetched
2025-09-22 13:05:54,670 - ERROR - API request failed for https://api.openaq.org/v3/sensors/7710/measurements: 408 Client Error: Request Timeout for url: https://api.openaq.org/v3/sensors/7710/measurements?date_from=2024-01-01T00%3A00%3A00Z&date_to=2025-09-22T07%3A18%3A57.217666%2B00%3A00&page=17&limit=1000
2025-09-22 13:05:54,675 - INFO - Total measurements for sensor 7710: 16000
2025-09-22 13:05:56,169 - INFO - Saved 31000 measurements (test) records to test_data/test_measurements_20250922_130154.parquet
2025-09-22 13:05:56,171 - INFO -   Columns: ['value', 'flagInfo', 'parameter', 'period', 'coordinates', 'summary', 'coverage', 'sensor_id', 'sensor_name', 'location_id', 'location_name', 'country_name', 'country_code']
2025-09-22 13:05:56,171 - INFO -   Shape: (31000, 13)
2025-09-22 13:05:56,177 - INFO - Test ingestion completed!
